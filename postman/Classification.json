{
  "openapi": "3.0.1",
  "info": {
    "title": "OpenCDx Classification Service",
    "version": "v0"
  },
  "servers": [
    {
      "url": "https://localhost:8080/classification",
      "description": "Generated server url"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/ruleset/list": {
      "post": {
        "tags": [
          "open-cdx-rest-classification-controller"
        ],
        "operationId": "getRuleSets",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RuleSetsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuleSetsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/predict": {
      "post": {
        "tags": [
          "open-cdx-rest-predictor-controller"
        ],
        "operationId": "predict",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PredictorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PredictorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/classify": {
      "post": {
        "tags": [
          "open-cdx-rest-classification-controller"
        ],
        "operationId": "submitClassification",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ClassificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClassificationResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "RuleSetsRequest": {
        "type": "object",
        "properties": {
          "organizationId": {
            "type": "string"
          },
          "workspaceId": {
            "type": "string"
          }
        }
      },
      "RuleSet": {
        "type": "object",
        "properties": {
          "ruleId": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "category": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "RuleSetsResponse": {
        "type": "object",
        "properties": {
          "ruleSets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RuleSet"
            }
          }
        }
      },
      "PredictorInput": {
        "type": "object",
        "properties": {
          "encounterId": {
            "type": "string"
          },
          "testId": {
            "type": "string"
          },
          "testFeatures": {
            "type": "array",
            "properties": {
              "underlyingElements": {
                "type": "array",
                "items": {
                  "type": "object"
                }
              },
              "unmodifiableView": {
                "type": "array",
                "properties": {
                  "underlyingElements": {
                    "type": "array",
                    "items": {
                      "type": "object"
                    }
                  },
                  "empty": {
                    "type": "boolean"
                  },
                  "first": {
                    "type": "string"
                  },
                  "last": {
                    "type": "string"
                  }
                },
                "items": {
                  "type": "string"
                }
              },
              "empty": {
                "type": "boolean"
              },
              "first": {
                "type": "string"
              },
              "last": {
                "type": "string"
              },
              "modifiable": {
                "type": "boolean"
              }
            },
            "items": {
              "type": "string"
            }
          }
        }
      },
      "PredictorRequest": {
        "type": "object",
        "properties": {
          "predictorInput": {
            "$ref": "#/components/schemas/PredictorInput"
          }
        }
      },
      "PredictorOutput": {
        "type": "object",
        "properties": {
          "encounterId": {
            "type": "string"
          },
          "predictedValue": {
            "type": "string"
          }
        }
      },
      "PredictorResponse": {
        "type": "object",
        "properties": {
          "predictorOutput": {
            "$ref": "#/components/schemas/PredictorOutput"
          }
        }
      },
      "ClassificationRequest": {
        "type": "object",
        "properties": {
          "userAnswer": {
            "$ref": "#/components/schemas/UserAnswer"
          }
        }
      },
      "Duration": {
        "type": "object",
        "properties": {
          "duration": {
            "type": "integer",
            "format": "int64"
          },
          "type": {
            "type": "string",
            "enum": [
              "DURATION_TYPE_NOT_SPECIFIED",
              "DURATION_TYPE_MILLISECONDS",
              "DURATION_TYPE_SECONDS",
              "DURATION_TYPE_MINUTES",
              "DURATION_TYPE_HOURS",
              "DURATION_TYPE_DAYS",
              "DURATION_TYPE_WEEKS",
              "DURATION_TYPE_MONTHS",
              "DURATION_TYPE_YEARS",
              "UNRECOGNIZED"
            ]
          }
        }
      },
      "Location": {
        "type": "object",
        "properties": {
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "Symptom": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "severity": {
            "type": "string",
            "enum": [
              "UNSPECIFIED_SEVERITY_LEVEL",
              "SEVERITY_LEVEL_LOW",
              "SEVERITY_LEVEL_MEDIUM",
              "SEVERITY_LEVEL_HIGH",
              "UNRECOGNIZED"
            ]
          },
          "onsetDate": {
            "$ref": "#/components/schemas/Timestamp"
          },
          "duration": {
            "$ref": "#/components/schemas/Duration"
          },
          "additionalDetails": {
            "type": "string"
          }
        }
      },
      "Timestamp": {
        "type": "object",
        "properties": {
          "seconds": {
            "type": "integer",
            "format": "int64"
          },
          "nanos": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "UserAnswer": {
        "type": "object",
        "properties": {
          "patientId": {
            "type": "string"
          },
          "connectedTestId": {
            "type": "string"
          },
          "userQuestionnaireId": {
            "type": "string"
          },
          "symptoms": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Symptom"
            }
          },
          "age": {
            "type": "integer",
            "format": "int32"
          },
          "gender": {
            "type": "string",
            "enum": [
              "GENDER_NOT_SPECIFIED",
              "GENDER_MALE",
              "GENDER_FEMALE",
              "GENDER_NON_BINARY",
              "GENDER_OTHER",
              "UNRECOGNIZED"
            ]
          },
          "medicalConditions": {
            "type": "string"
          },
          "pregnancyStatus": {
            "type": "boolean"
          },
          "languagePreference": {
            "type": "string"
          },
          "userLocation": {
            "$ref": "#/components/schemas/Location"
          },
          "submittingUserId": {
            "type": "string"
          },
          "mediaId": {
            "type": "string"
          },
          "textResult": {
            "type": "string"
          }
        }
      },
      "ANFStatement": {
        "type": "object",
        "properties": {
          "time": {
            "$ref": "#/components/schemas/Measure"
          },
          "subjectOfRecord": {
            "$ref": "#/components/schemas/Participant"
          },
          "authors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Practitioner"
            }
          },
          "subjectOfInformation": {
            "type": "string"
          },
          "associatedStatement": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssociatedStatement"
            }
          },
          "topic": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "circumstanceChoice": {
            "$ref": "#/components/schemas/CircumstanceChoice"
          },
          "created": {
            "$ref": "#/components/schemas/Timestamp"
          },
          "modified": {
            "$ref": "#/components/schemas/Timestamp"
          },
          "creator": {
            "type": "string"
          },
          "modifier": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "STATUS_UNSPECIFIED",
              "STATUS_ACTIVE",
              "STATUS_DELETED",
              "UNRECOGNIZED"
            ]
          }
        }
      },
      "AssociatedStatement": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "semantic": {
            "type": "string"
          }
        }
      },
      "CircumstanceChoice": {
        "type": "object",
        "properties": {
          "circumstanceType": {
            "type": "string",
            "enum": [
              "PERFORMANCE_CIRCUMSTANCE",
              "REQUEST_CIRCUMSTANCE",
              "NARRATIVE_CIRCUMSTANCE",
              "UNRECOGNIZED"
            ]
          },
          "status": {
            "type": "string"
          },
          "result": {
            "$ref": "#/components/schemas/Measure"
          },
          "healthRisk": {
            "type": "string"
          },
          "normalRange": {
            "$ref": "#/components/schemas/Measure"
          },
          "circumstance": {
            "$ref": "#/components/schemas/Participant"
          },
          "timing": {
            "$ref": "#/components/schemas/Measure"
          },
          "participant": {
            "$ref": "#/components/schemas/Participant"
          }
        }
      },
      "Classification": {
        "type": "object",
        "properties": {
          "testKit": {
            "$ref": "#/components/schemas/TestKit"
          },
          "confidence": {
            "type": "number",
            "format": "float"
          },
          "positiveProbability": {
            "type": "number",
            "format": "float"
          },
          "message": {
            "type": "string"
          },
          "availability": {
            "type": "string"
          },
          "cost": {
            "type": "number",
            "format": "float"
          },
          "furtherActions": {
            "type": "string"
          },
          "alternativeOptions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TestKit"
            }
          },
          "feedbackUrl": {
            "type": "string"
          },
          "timestamp": {
            "$ref": "#/components/schemas/Timestamp"
          },
          "patientId": {
            "type": "string"
          },
          "notifyCdc": {
            "type": "boolean"
          },
          "type": {
            "type": "string",
            "enum": [
              "UNSPECIFIED_CLASSIFICATION_TYPE",
              "BACTERIAL",
              "VIRAL",
              "INJURY",
              "UNRECOGNIZED"
            ]
          },
          "diagnosis": {
            "$ref": "#/components/schemas/DiagnosisCode"
          }
        }
      },
      "ClassificationResponse": {
        "type": "object",
        "properties": {
          "classification": {
            "$ref": "#/components/schemas/Classification"
          }
        }
      },
      "DiagnosisCode": {
        "type": "object",
        "properties": {
          "anfStatement": {
            "$ref": "#/components/schemas/ANFStatement"
          },
          "tinkarCode": {
            "type": "string"
          },
          "valueMap": {
            "type": "object",
            "additionalProperties": {
              "type": "string",
              "deprecated": true
            },
            "deprecated": true
          },
          "providerId": {
            "type": "string"
          }
        }
      },
      "Interpretation": {
        "type": "object",
        "properties": {
          "positive": {
            "type": "object",
            "additionalProperties": {
              "type": "string",
              "deprecated": true
            },
            "deprecated": true
          },
          "negative": {
            "type": "object",
            "additionalProperties": {
              "type": "string",
              "deprecated": true
            },
            "deprecated": true
          }
        }
      },
      "Measure": {
        "type": "object",
        "properties": {
          "upperBound": {
            "type": "string"
          },
          "lowerBound": {
            "type": "string"
          },
          "includeUpperBound": {
            "type": "boolean"
          },
          "includeLowerBound": {
            "type": "boolean"
          },
          "semantic": {
            "type": "string"
          },
          "resolution": {
            "type": "string"
          }
        }
      },
      "Participant": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "practitionerValue": {
            "type": "string"
          },
          "code": {
            "type": "string"
          }
        }
      },
      "Practitioner": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "practitionerValue": {
            "type": "string"
          },
          "code": {
            "type": "string"
          }
        }
      },
      "TestKit": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "targetDisease": {
            "type": "string"
          },
          "specimenType": {
            "type": "string",
            "enum": [
              "SPECIMEN_TYPE_UNSPECIFIED",
              "SPECIMEN_TYPE_BLOOD",
              "SPECIMEN_TYPE_URINE",
              "SPECIMEN_TYPE_SALIVA",
              "UNRECOGNIZED"
            ]
          },
          "procedure": {
            "type": "string"
          },
          "interpretationGuide": {
            "$ref": "#/components/schemas/Interpretation"
          },
          "brand": {
            "type": "string"
          },
          "approvalStatus": {
            "type": "string"
          },
          "accuracy": {
            "type": "number",
            "format": "float"
          },
          "testDuration": {
            "type": "integer",
            "format": "int32"
          },
          "testCaseId": {
            "type": "string"
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "name": "bearerAuth",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}